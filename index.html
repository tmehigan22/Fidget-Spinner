<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Classic Fidget Spinner</title>

  <style>
    :root {
      --bg: #00A6FB;
      --body: #ECF6FB;
      --ring-dark: #0B0B0B;
      --ring-mid: #1E1E1E;
      --white: #FFFFFF;
      --shadow: 0 20px 48px rgba(0,0,0,.25);
    }

    html, body {
      height: 100%;
      margin: 0;
      background: var(--bg);
      touch-action: none;
      overscroll-behavior: none;
      user-select: none;
    }

    .wrap {
      height: 100%;
      display: grid;
      place-items: center;
    }

    .spinner {
      width: min(70vmin, 360px);
      aspect-ratio: 1;
      position: relative;
      transform: rotate(0rad);
      will-change: transform;
      filter: drop-shadow(var(--shadow));
    }

    /* Center logo */
    .logo {
      position: absolute;
      inset: 0;
      display: grid;
      place-items: center;
      pointer-events: none;
    }

    .logo-circle {
      width: 26%;
      height: 26%;
      border-radius: 50%;
      background: var(--ring-dark);
      display: grid;
      place-items: center;
      overflow: hidden;
    }

    .logo-circle img {
      width: 70%;
      height: 70%;
      object-fit: contain;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div id="spinner" class="spinner">
      <!-- Classic spinner geometry -->
      <svg viewBox="-200 -200 400 400" width="100%" height="100%">
        <!-- Body -->
        <g fill="var(--body)">
          <circle cx="0" cy="-100" r="78"/>
          <circle cx="86.6" cy="50" r="78"/>
          <circle cx="-86.6" cy="50" r="78"/>
          <circle cx="0" cy="0" r="95"/>
        </g>

        <!-- Bearings -->
        <g>
          <!-- Top -->
          <g transform="translate(0,-100)">
            <circle r="36" fill="var(--ring-dark)"/>
            <circle r="26" fill="var(--body)"/>
            <circle r="14" fill="var(--white)"/>
          </g>

          <!-- Right -->
          <g transform="translate(86.6,50)">
            <circle r="36" fill="var(--ring-dark)"/>
            <circle r="26" fill="var(--body)"/>
            <circle r="14" fill="var(--white)"/>
          </g>

          <!-- Left -->
          <g transform="translate(-86.6,50)">
            <circle r="36" fill="var(--ring-dark)"/>
            <circle r="26" fill="var(--body)"/>
            <circle r="14" fill="var(--white)"/>
          </g>

          <!-- Center bearing -->
          <circle r="50" fill="var(--ring-dark)"/>
        </g>
      </svg>

      <!-- Logo -->
      <div class="logo">
        <div class="logo-circle">
          <img src="logo.png" alt="App logo" />
        </div>
      </div>
    </div>
  </div>

  <script>
    (() => {
      const spinner = document.getElementById("spinner");

      let angle = 0;
      let omega = 0;
      let dragging = false;

      const MAX_OMEGA = 32;
      const FRICTION = 1.6;
      const MIN_OMEGA = 0.05;

      let center = { x: 0, y: 0 };
      let lastAngle = 0;
      const samples = [];

      function updateCenter() {
        const r = spinner.getBoundingClientRect();
        center.x = r.left + r.width / 2;
        center.y = r.top + r.height / 2;
      }

      function pointerAngle(x, y) {
        return Math.atan2(y - center.y, x - center.x);
      }

      function normalize(d) {
        while (d > Math.PI) d -= Math.PI * 2;
        while (d < -Math.PI) d += Math.PI * 2;
        return d;
      }

      function setRotation(r) {
        angle = r;
        spinner.style.transform = `rotate(${angle}rad)`;
      }

      function estimateOmega() {
        if (samples.length < 2) return 0;
        const first = samples[0];
        const last = samples[samples.length - 1];
        const dt = (last.t - first.t) / 1000;
        if (dt <= 0) return 0;
        return (last.a - first.a) / dt;
      }

      spinner.addEventListener("pointerdown", e => {
        updateCenter();
        dragging = true;
        omega = 0;
        samples.length = 0;
        lastAngle = pointerAngle(e.clientX, e.clientY);
        samples.push({ t: performance.now(), a: lastAngle });
        spinner.setPointerCapture(e.pointerId);
      });

      spinner.addEventListener("pointermove", e => {
        if (!dragging) return;
        const a = pointerAngle(e.clientX, e.clientY);
        const d = normalize(a - lastAngle);
        setRotation(angle + d);
        lastAngle = a;
        samples.push({ t: performance.now(), a });
        if (samples.length > 8) samples.shift();
      });

      spinner.addEventListener("pointerup", () => {
        dragging = false;
        omega = Math.max(-MAX_OMEGA, Math.min(MAX_OMEGA, estimateOmega()));
        if (Math.abs(omega) < 0.6) omega = 0;
      });

      let lastFrame = performance.now();
      function animate(now) {
        const dt = (now - lastFrame) / 1000;
        lastFrame = now;

        if (!dragging && Math.abs(omega) > 0) {
          omega *= Math.exp(-FRICTION * dt);
          if (Math.abs(omega) < MIN_OMEGA) omega = 0;
          else setRotation(angle + omega * dt);
        }
        requestAnimationFrame(animate);
      }

      updateCenter();
      window.addEventListener("resize", updateCenter);
      requestAnimationFrame(animate);
    })();
  </script>
</body>
</html>
